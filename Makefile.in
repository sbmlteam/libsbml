## @configure_input@
##
## Filename    : Makefile.in
## Description : Makefile template for use by 'configure'
## Author(s)   : SBML Team <sbml-team@caltech.edu>
## Organization: California Institute of Technology
## Created     : 2004-05-31
## Revision    : $Id$
## Source      : $Source$
##
##<!---------------------------------------------------------------------------
## This file is part of libSBML.  Please visit http://sbml.org for more
## information about SBML, and the latest version of libSBML.
##
## Copyright 2005-2007 California Institute of Technology.
## Copyright 2002-2005 California Institute of Technology and
##                     Japan Science and Technology Corporation.
## 
## This library is free software; you can redistribute it and/or modify it
## under the terms of the GNU Lesser General Public License as published by
## the Free Software Foundation.  A copy of the license agreement is provided
## in the file named "LICENSE.txt" included with this software distribution
## and also available online as http://sbml.org/software/libsbml/license.html
##----------------------------------------------------------------------- -->*/


# -----------------------------------------------------------------------------
# Configuration variables
# -----------------------------------------------------------------------------
# Some of the following are substituted automatically by `configure'.  If
# you are looking at "Makefile", do not edit these values; instead, run the
# configure script at the top level of the src tree.  It will recreate
# "Makefile".

include @top_srcdir@/config/makefile-common-vars.mk

# `srcdir' points to the current directory, but should be set by configure.
# `subdir' must be set manually to the relative dir under `srcdir'.  Don't 
# set `subdir' to an absolute path, or some make actions will fail.

srcdir  = @srcdir@
thisdir = .

# Variables `examples' and `xml-schemas' are local variables reused below.
# SK removed xml-schema files

examples =                                                       \
  examples/README.txt                                            \
  examples/c/Makefile.in                                         \
  examples/c/FormulaGraphvizFormatter.h                          \
  examples/c/convertSBML.c                                       \
  examples/c/drawMath.c                                          \
  examples/c/echoSBML.c                                          \
  examples/c/evaluateMath.c                                      \
  examples/c/printMath.c                                         \
  examples/c/printSBML.c                                         \
  examples/c/readSBML.c                                          \
  examples/c/translateMath.c                                     \
  examples/c/util.c                                              \
  examples/c/util.h                                              \
  examples/c/validateSBML.c                                      \
  examples/c++/Makefile.in                                       \
  examples/c++/appendAnnotation.cpp                              \
  examples/c++/printAnnotation.cpp                               \
  examples/c++/printNotes.cpp                                    \
  examples/c++/unsetAnnotation.cpp                               \
  examples/c++/unsetNotes.cpp                                    \
  examples/c++/addCVTerms.cpp                                    \
  examples/c++/addModelHistory.cpp                               \
  examples/c++/convertSBML.cpp                                   \
  examples/c++/echoSBML.cpp                                      \
  examples/c++/printMath.cpp                                     \
  examples/c++/printSBML.cpp                                     \
  examples/c++/readSBML.cpp                                      \
  examples/c++/translateMath.cpp                                 \
  examples/c++/util.c                                            \
  examples/c++/util.h                                            \
  examples/c++/validateSBML.cpp                                  \
  examples/java/Makefile.in                                      \
  examples/java/README.txt                                       \
  examples/java/convertSBML.java                                 \
  examples/java/evaluateMath.java                                \
  examples/java/printMath.java                                   \
  examples/java/printSBML.java                                   \
  examples/java/readSBML.java                                    \
  examples/java/translateMath.java                               \
  examples/java/validateSBML.java                                \
  examples/layout/Makefile.in                                    \
  examples/layout/example1.cpp                                   \
  examples/layout/example2.cpp                                   \
  examples/layout/example3.cpp                                   \
  examples/layout/example1.java                                  \
  examples/layout/example1.py                                    \
  examples/layout/layout2svg.xsl                                 \
  examples/perl/convertSBML.pl                                   \
  examples/perl/evaluateMath.pl                                  \
  examples/perl/extractReactionInfo.pl                           \
  examples/perl/extractReactions.pl                              \
  examples/perl/printMath.pl                                     \
  examples/perl/printSBML.pl                                     \
  examples/perl/readSBML.pl                                      \
  examples/perl/translateMath.pl                                 \
  examples/perl/validateSBML.pl                                  \
  examples/sample-models/README.txt                              \
  examples/sample-models/from-spec/level-2/README.txt            \
  examples/sample-models/from-spec/level-2/algebraicrules.xml    \
  examples/sample-models/from-spec/level-2/assignmentrules.xml   \
  examples/sample-models/from-spec/level-2/boundarycondition.xml \
  examples/sample-models/from-spec/level-2/delay.xml             \
  examples/sample-models/from-spec/level-2/dimerization.xml      \
  examples/sample-models/from-spec/level-2/enzymekinetics.xml    \
  examples/sample-models/from-spec/level-2/events.xml            \
  examples/sample-models/from-spec/level-2/functiondef.xml       \
  examples/sample-models/from-spec/level-2/multicomp.xml         \
  examples/sample-models/from-spec/level-2/overdetermined.xml    \
  examples/sample-models/from-spec/level-2/twodimensional.xml    \
  examples/sample-models/from-spec/level-2/units.xml


# The files listed in `docs' are copied to the documentation directory
# during a `make install'.

docs =         \
  AUTHORS.txt  \
  COPYING.html \
  COPYING.txt  \
  FUNDING.txt  \
  LICENSE.txt  \
  LICENSE.html \
  NEWS.txt     \
  README.txt   \
  VERSION.txt  \
  $(examples)                                          

# Variables `subdirs', `headers', `sources', `libraries', `extra_CPPFLAGS',
# `extra_CXXFLAGS', `extra_LDFLAGS', `extra_clean', and `distfiles' are
# used by the default rules in `makefile-common-actions.mk' included at the
# end.

subdirs = src docs win32

# `distfile' is the list of files used for creating distributions,
# something that only the libSBML developers should do.  The list of files
# here is in addition to the subdirectories listed in `subdirs'.  The
# latter are the object of `make dist' and the files that are collected
# are under the control of the makefiles in the subdirectories.

distfiles =                         \
  AUTHORS.txt                       \
  COPYING.html                      \
  COPYING.txt                       \
  FUNDING.txt                       \
  LICENSE.txt                       \
  LICENSE.html                      \
  Makefile.in                       \
  NEWS.txt                          \
  README.txt                        \
  VERSION.txt                       \
  aclocal.m4                        \
  config/config.guess               \
  config/config.sub                 \
  config/doxygen.m4                 \
  config/expat.m4                   \
  config/install-sh                 \
  config/java.m4                    \
  config/libcheck.m4                \
  config/libxml.m4                  \
  config/lisp.m4                    \
  config/makefile-common-actions.mk \
  config/makefile-common-vars.mk.in \
  config/matlab.m4                  \
  config/missing                    \
  config/mkinstalldirs              \
  config/octave.m4                  \
  config/perl.m4                    \
  config/python.m4                  \
  config/runldpath.m4               \
  config/swig.m4                    \
  config/xercesc.m4                 \
  configure                         \
  configure.ac                      \
  $(examples)                              

# The files listed in `extra_distclean' are items created by configure or
# make, and that are removed by the default rules for `make distclean' in
# makefile-common-actions.mk.

extra_distclean = config.status config.cache config.log autom4te.cache \
	src/common/config.h src/common/stamp-h1

# It's safer to remove and recreate the copy of the include files (in the
# 'include' directory) after a make clean.  Previously we did it in a make
# distclean only, but I've run into situations where the copy didn't get
# updated.  This is a bit of a sledgehammer, but it's not too bad.

extra_clean = include libsbml.pc

ifeq "$(HOST_TYPE)" "cygwin"
  extra_clean += libsbml.la
endif


# -----------------------------------------------------------------------------
# Primary build actions.
# -----------------------------------------------------------------------------

# The default rules in `makefile-common-actions.mk' know to interpret goals
# of the form `foo-recursive' to run 'make foo' in directories defined in
# variable `subdirs'.

all: configure Makefile include all-recursive libsbml.pc libsbml.la

docs:;
ifneq "$(MAKEFLAGS)" ""
	$(MAKE) -w -C docs -$(MAKEFLAGS) $(MAKECMDGOALS)
else
	$(MAKE) -w -C docs $(MAKECMDGOALS)
endif

include: include-recursive


# -----------------------------------------------------------------------------
# Checking.
# -----------------------------------------------------------------------------

check: all check-recursive


# -----------------------------------------------------------------------------
# Tags.
# -----------------------------------------------------------------------------

tags: etags-recursive ctags-recursive


# -----------------------------------------------------------------------------
# libsbml.pc.
# -----------------------------------------------------------------------------

base-libs = -lsbml -lstdc++ -lm

libsbml.pc: Makefile
	@rm -f libsbml.pc
	@echo "Name: @PACKAGE_NAME@"                   > libsbml.pc
	@echo "Description: An API library for reading/writing/manipulating SBML" >> libsbml.pc
	@echo "URL: http://sbml.org/software/libsbml" >> libsbml.pc
	@echo "Version: @PACKAGE_VERSION@"            >> libsbml.pc
	@echo ""                                      >> libsbml.pc
	@echo "prefix=@prefix@"                       >> libsbml.pc
	@echo "exec_prefix=@exec_prefix@"             >> libsbml.pc
	@echo "libdir=@libdir@"                       >> libsbml.pc
	@echo "includedir=@includedir@"               >> libsbml.pc
	@echo ""                                      >> libsbml.pc
ifdef USE_XERCES
	@echo "Libs: -L\$${libdir} ${XERCES_LDFLAGS} ${XERCES_LIBS} ${base-libs}" >> libsbml.pc
	@echo "Cflags: -I\$${includedir} ${XERCES_CPPFLAGS}" >> libsbml.pc
	@echo "Conflicts: xerces-c = 2.6.0"           >> libsbml.pc
endif
ifdef USE_EXPAT
	@echo "Libs: -L\$${libdir} ${EXPAT_LDFLAGS} ${EXPAT_LIBS} ${base-libs}" >> libsbml.pc
	@echo "Cflags: -I\$${includedir} ${EXPAT_CPPFLAGS}"  >> libsbml.pc
endif
ifdef USE_LIBXML
	@echo "Libs: -L\$${libdir} ${base-libs}"      >> libsbml.pc
	@echo "Cflags: -I\$${includedir}"             >> libsbml.pc
	@echo "Requires: libxml-2.0 >= 2.6.22"        >> libsbml.pc
endif


# -----------------------------------------------------------------------------
# libsbml.la.
# -----------------------------------------------------------------------------

# Currently we only need to provide this under cygwin.  Maybe we should also
# provide it for libtool users on other platforms?

libsbml.la: Makefile
ifeq "$(HOST_TYPE)" "cygwin"
	@rm -f libsbml.pc
	@echo "# libsbml.la"                             > libsbml.la
	@echo "# Generated by libSBML's Makefile."      >> libsbml.la
	@echo ""                                        >> libsbml.la
	@echo "library_names='libsbml.$(SHAREDLIBEXT)'" >> libsbml.la
	@echo "libdir='$(LIBDIR)'"                      >> libsbml.la
	@echo "dlname=''"                               >> libsbml.la
	@echo "dlopen=''"                               >> libsbml.la
	@echo "dlpreopen=''"                            >> libsbml.la
	@echo "old_library=''"                          >> libsbml.la
	@echo "current=0"                               >> libsbml.la
	@echo "age=0"                                   >> libsbml.la
	@echo "revision=0"                              >> libsbml.la
	@echo "installed=yes"                           >> libsbml.la
	@echo "shouldnotlink=no"                        >> libsbml.la
  ifdef USE_XERCES
	@echo "dependency_libs='${XERCES_LDFLAGS} ${XERCES_LIBS}'" >> libsbml.la
  endif
  ifdef USE_EXPAT
	@echo "dependency_libs='${EXPAT_LDFLAGS} ${EXPAT_LIBS}'"   >> libsbml.la
  endif
  ifdef USE_LIBXML
	@echo "dependency_libs='${LIBXML_LDFLAGS} ${LIBXML_LIBS}'" >> libsbml.la
  endif
endif


# -----------------------------------------------------------------------------
# Installation.
# -----------------------------------------------------------------------------

install: all install-recursive install-warnings install-pc install-la

install-docs: install-docs-recursive

installcheck: installcheck-recursive

install-warnings:
ifneq "$(HOST_TYPE)" "darwin"
	@echo ""
	@echo "The installation of libSBML is finished.  On certain platforms"
	@echo "(such as Linux), you will also need to do one of the following:"
	@echo "1) run 'ldconfig' (see the man page if this is unfamiliar)"
	@echo "2) set the LD_LIBRARY_PATH (or equivalent) environment variable"
	@echo ""
endif

install-pc: libsbml.pc
	$(INSTALL_SH) libsbml.pc -m 0644 "$(DESTDIR)$(LIBDIR)/pkgconfig/libsbml.pc"

install-la: libsbml.la
ifeq "$(HOST_TYPE)" "cygwin"
	$(INSTALL_SH) libsbml.la -m 0644 "$(DESTDIR)$(LIBDIR)/libsbml.la"
endif


uninstall: uninstall-recursive uninstall-libsbml-pc uninstall-libsbml-la
	@if test -d "$(DESTDIR)$(LIBDIR)"; then \
	  if test -n "`find $(DESTDIR)$(LIBDIR) -maxdepth 0 -empty`"; then \
	    echo rmdir "$(DESTDIR)$(LIBDIR)"; \
	    rmdir "$(DESTDIR)$(LIBDIR)"; \
	  else \
	    echo "Directory $(DESTDIR)$(LIBDIR) not empty; leaving it alone"; \
	  fi; \
	fi; \
	if test -d "$(DESTDIR)$(INCLUDEDIR)"; then \
	  if test -n "`find $(DESTDIR)$(INCLUDEDIR) -maxdepth 0 -empty`"; then \
	    echo rmdir "$(DESTDIR)$(INCLUDEDIR)"; \
	    rmdir "$(DESTDIR)$(INCLUDEDIR)"; \
	  else \
	    echo "Directory $(DESTDIR)$(INCLUDEDIR) not empty; leaving it alone"; \
	  fi; \
	fi; \
	if test -d "$(DESTDIR)"; then \
	  if test -n "`find $(DESTDIR) -maxdepth 0 -empty`"; then \
	    echo rmdir "$(DESTDIR)"; \
	    rmdir "$(DESTDIR)"; \
	  else \
	    echo "Directory $(DESTDIR) not empty; leaving it alone"; \
	  fi; \
	fi;

uninstall-libsbml-pc:
	@target="$(DESTDIR)$(LIBDIR)/pkgconfig/libsbml.pc"; \
	if test -f $$target ; then \
	  echo rm $$target; \
	  rm $$target; \
	fi; \
	if test -d "$(DESTDIR)$(LIBDIR)/pkgconfig"; then \
	  if test -n "`find $(DESTDIR)$(LIBDIR) -maxdepth 0 -empty`"; then \
	    echo rmdir "$(DESTDIR)$(LIBDIR)/pkgconfig"; \
	    rmdir "$(DESTDIR)$(LIBDIR)/pkgconfig"; \
	  else \
	    echo "Directory $(DESTDIR)$(LIBDIR)/pkgconfig not empty; leaving it alone"; \
	  fi; \
	fi;

uninstall-libsbml-la:
ifeq "$(HOST_TYPE)" "cygwin"
	@target="$(DESTDIR)$(LIBDIR)/libsbml.la"; \
	if test -f $$target ; then \
	  echo rm $$target; \
	  rm $$target; \
	fi;
endif


# -----------------------------------------------------------------------------
# Cleaning.
# -----------------------------------------------------------------------------

clean: clean-normal clean-recursive

distclean: distclean-normal distclean-recursive

mostlyclean: mostlyclean-normal mostlyclean-recursive

maintainer-clean: maintainer-clean-normal maintainer-clean-recursive


# -----------------------------------------------------------------------------
# Creating distribution (for libSBML maintainers only)
# -----------------------------------------------------------------------------

# The `make dist' command is only available from this top-level makefile.

remove_distdir = \
  { test ! -d $(DISTDIR) \
    || { find $(DISTDIR) -type d ! -perm -200 -exec chmod u+w {} ';' \
         && rm -fr $(DISTDIR); }; }

# Don't use GNU make's $(basename ...) command in the following; it behaves
# differently in a critical way (specifically, in its handling of dots).

archive_basename = $(shell basename $(DISTDIR))
tar_archive      = $(archive_basename).tar.gz
zip_archive      = $(archive_basename).zip

dist-gzip: config-check dist-all
	if test -d $(DISTDIR); then \
	  GZIP="--best" tar -C $(DISTDIR)/.. \
		-chozf $(tar_archive) $(notdir $(DISTDIR)); \
	  $(remove_distdir); \
	fi

dist dist-zip: config-check dist-all
	if test -d $(DISTDIR); then				\
	  cd $(DISTDIR)/..					\
	  && zip -vr9  $(zip_archive) "$(archive_basename)"	\
	  && zip -vlr9 $(zip_archive)				\
	   `find "$(archive_basename)" -name '*.dsp' -o -name '*.dsw' -o -name '*.vcproj'`\
	  && $(remove_distdir); \
	fi

# For `make dist' to work properly, we need the developer to configure
# libsbml with certain flags, so that certain auto-generated files are
# present when `make dist' runs and looks for them.

# 2007-06-05 Temporarily disabling the Lisp bindings.
# check_vars_list = USE_SWIG USE_JAVA USE_LISP USE_PYTHON USE_PERL
check_vars_list = USE_SWIG USE_JAVA USE_PYTHON USE_PERL
num_vars        = $(words $(check_vars_list))
num_vars_set    = $(words $(foreach var,$(check_vars_list),$($(var))))

config-check:
	@if test $(num_vars_set) != $(num_vars); then \
	  echo "Please reconfigure with options $(check_vars_list)"; \
	  echo "before running 'make dist'"; \
	  exit 2; \
	fi

dist-all: $(distfiles)
	$(MAKE) $(MAKEFLAGS) all
	-rm -f $(distarchive)
	@$(remove_distdir)
	mkdir -p $(DISTDIR)
	@list='$(distfiles)'; for file in $$list; do \
	  if test -f $$file || test -d $$file; then d=.; else d=$(srcdir); fi; \
	  dir=`echo "$$file" | sed -e 's,/[^/]*$$,,'`; \
	  if test "$$dir" != "$$file" && test "$$dir" != "."; then \
	    dir="$$dir"; \
	    $(MKINSTALLDIRS) "$(DISTDIR)/$$dir"; \
	  else \
	    dir=''; \
	  fi; \
	  if test -d $$d/$$file; then \
	    if test -d $(srcdir)/$$file && test $$d != $(srcdir); then \
	      cp -pR $(srcdir)/$$file $(DISTDIR)/$$dir || exit 1; \
	    fi; \
	    cp -pR $$d/$$file $(DISTDIR)/$$dir || exit 1; \
	  else \
	    test -f $(DISTDIR)/$$file \
	    || cp -p $$d/$$file $(DISTDIR)/$$file \
	    || exit 1; \
	  fi; \
	done
	@list='$(subdirs)'; for subdir in $$list; do \
	  if test "$$subdir" = .; then :; else \
	    test -d $(DISTDIR)/$$subdir \
	    || mkdir $(DISTDIR)/$$subdir \
	    || exit 1; \
	    $(MAKE) $(MAKEFLAGS) -wC $$subdir \
	        TOP_DISTDIR="$(TOP_DISTDIR)" \
	        DISTDIR=$(DISTDIR) \
	        dist \
	      || exit 1; \
	  fi; \
	done
	-@find $(DISTDIR) -type d ! -perm -777 -exec chmod a+rwx {} \; -o \
	  ! -type d ! -perm -444 -links 1 -exec chmod a+r {} \; -o \
	  ! -type d ! -perm -400 -exec chmod a+r {} \; -o \
	  ! -type d ! -perm -444 -exec $(SHELL) $(INSTALL_SH) -c -m a+r {} {} \; \
	|| chmod -R a+r $(DISTDIR)

## This target untars the dist file and tries a VPATH configuration.  Then
## it guarantees that the distribution is self-contained by making another
## tarfile.
#distcheck: dist
#	$(remove_distdir)
#	GZIP=$(gzip_env) gunzip -c $(distdir).tar.gz | $(AMTAR) xf -
#	chmod -R a-w $(distdir); chmod a+w $(distdir)
#	mkdir $(distdir)/=build
#	mkdir $(distdir)/=inst
#	chmod a-w $(distdir)
#	dc_install_base=`$(am__cd) $(distdir)/=inst && pwd` \
#	  && dc_destdir="$${TMPDIR-/tmp}/am-dc-$$$$/" \
#	  && cd $(distdir)/=build \
#	  && ../configure --srcdir=.. --prefix="$$dc_install_base" \
#	    $(DISTCHECK_CONFIGURE_FLAGS) \
#	  && $(MAKE) $(AM_MAKEFLAGS) \
#	  && $(MAKE) $(AM_MAKEFLAGS) dvi \
#	  && $(MAKE) $(AM_MAKEFLAGS) check \
#	  && $(MAKE) $(AM_MAKEFLAGS) install \
#	  && $(MAKE) $(AM_MAKEFLAGS) installcheck \
#	  && $(MAKE) $(AM_MAKEFLAGS) uninstall \
#	  && $(MAKE) $(AM_MAKEFLAGS) distuninstallcheck_dir="$$dc_install_base" \
#	        distuninstallcheck \
#	  && chmod -R a-w "$$dc_install_base" \
#	  && ({ \
#	       (cd ../.. && $(MKINSTALLDIRS) "$$dc_destdir") \
#	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" install \
#	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" uninstall \
#	       && $(MAKE) $(AM_MAKEFLAGS) DESTDIR="$$dc_destdir" \
#	            distuninstallcheck_dir="$$dc_destdir" distuninstallcheck; \
#	      } || { rm -rf "$$dc_destdir"; exit 1; }) \
#	  && rm -rf "$$dc_destdir" \
#	  && $(MAKE) $(AM_MAKEFLAGS) dist-gzip \
#	  && rm -f $(distdir).tar.gz \
#	  && $(MAKE) $(AM_MAKEFLAGS) distcleancheck
#	$(remove_distdir)
#	@echo "$(distdir).tar.gz is ready for distribution" | \
#	  sed 'h;s/./=/g;p;x;p;x'

#distuninstallcheck:
#	cd $(distuninstallcheck_dir) \
#	&& test `find . -type f -print | wc -l` -le 1 \
#	   || { echo "ERROR: files left after uninstall:" ; \
#	        if test -n "$(DESTDIR)"; then \
#	          echo "  (check DESTDIR support)"; \
#	        fi ; \
#	        find . -type f -print ; \
#	        exit 1; } >&2

#distcleancheck: distclean
#	if test '$(srcdir)' = . ; then \
#	  echo "ERROR: distcleancheck can only run from a VPATH build" ; \
#	  exit 1 ; \
#	fi
#	test `find . -type f -print | wc -l` -eq 0 \
#	  || { echo "ERROR: files left in build directory after distclean:" ; \
#	       find -type f -print ; \
#	       exit 1; } >&2


# -----------------------------------------------------------------------------
# Common default rules.
# -----------------------------------------------------------------------------

include @top_srcdir@/config/makefile-common-actions.mk


# -----------------------------------------------------------------------------
# End.
# -----------------------------------------------------------------------------
